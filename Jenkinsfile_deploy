pipeline {
    agent {
        node {
            label 'node_main'
        }
    }
    stages {
        stage('Deploy artifact') {
            steps {
                node('node_artifactory'){
                   sh '''
                   ls -la 
                   pwd
                   touch q
                   cp /home/ubuntu/workspace/Project_build/spring_petclinic/target/*.jar .
                   '''
                   stash name: "artifact", includes: "q"
                }
            }
        }
        stage('Start application') {
            steps {
                node('node_prod'){
                    unstash name: "artifact"
                }
            }
        }
    }
}
